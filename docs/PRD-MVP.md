# FocusLens MVP 产品需求文档（PRD）

## 1. 文档信息
- 产品名称：FocusLens
- 版本：MVP v0.1
- 文档状态：可执行
- 更新时间：2026-02-07
- 技术栈：Tauri（Rust + Web 前端）
- 竞品参考：Screen Studio、Focusee
- 核心定位：开源、离线优先、快速产出高质量产品演示录屏

## 2. 背景与目标

### 2.1 背景
当前高质量录屏工具多为闭源订阅模式。目标用户（产品团队）希望在进行功能演示、评审汇报、版本说明时，快速从录制到成片导出，且对隐私与可控性有明确诉求。

### 2.2 产品目标
在 6 周内交付一个可公开发布的开源 MVP，完成以下闭环：
1. 录制（屏幕 + 音频）  
2. 基础编辑（裁剪 + 比例）  
3. 自动镜头运动（鼠标跟随 + 平滑缩放）  
4. 本地导出 MP4  

### 2.3 成功标准（MVP）
1. 用户可在 10 分钟内完成首次录制到导出流程。  
2. 1080p 常规场景下，30 分钟录制过程不崩溃。  
3. 自动镜头运动对比“纯原始录屏”有明显观感提升。  
4. 开源仓库具备可运行、可贡献、可发布的最低标准。  

## 3. 用户与场景

### 3.1 目标用户
产品团队（PM、产品运营、解决方案、售前演示人员）。

### 3.2 典型场景
1. 新功能发布说明：录制“从入口到结果”的完整操作路径。  
2. 需求评审演示：展示交互细节，强调关键区域。  
3. 异步汇报：将产品状态以短视频形式发送给跨团队成员。  

### 3.3 用户痛点
1. 录完后仍需使用多个工具拼接和裁剪，耗时高。  
2. 普通录屏缺乏视觉引导，观众难以快速聚焦重点。  
3. 对云端上传和数据采集存在隐私顾虑。  

## 4. MVP 范围定义

### 4.1 In Scope（MVP 必做）
1. 桌面端平台：macOS、Windows。  
2. 录制：全屏/窗口选择、麦克风输入、系统音频（Windows 为 P0 必须；macOS 若受系统能力限制需降级并保持流程可用）。  
3. 录制控制：开始/暂停/停止、全局快捷键。  
4. 自动镜头运动：鼠标跟随、平滑缩放、强度可调、开关可控。  
5. 基础编辑：头尾裁剪、画布比例切换（16:9、9:16、1:1）。  
6. 基础视觉增强：光标高亮（基础样式）。  
7. 导出：本地 MP4、导出进度反馈、失败错误提示、可重试。  
8. 开源基础：许可证、贡献指南、Issue/PR 模板（最低可用版本）。  

### 4.2 Out of Scope（MVP 不做）
1. 云端上传、云端渲染、账号体系、团队协作。  
2. 在线模板市场。  
3. AI 字幕/文案自动生成。  
4. Linux 首发支持。  
5. 高级轨道编辑（多轨剪辑、关键帧特效、复杂转场）。  

## 5. 关键产品原则
1. 离线优先：默认不上传任何用户数据。  
2. 开源透明：核心流程与关键配置可审计。  
3. 简单优先：减少学习成本，优先保证录制-编辑-导出闭环稳定。  
4. 观感优先：自动镜头运动必须“自然、不突兀、可预测”。  

## 6. 功能需求（按优先级）

## 6.1 P0：录制模块
### 6.1.1 录制源选择
1. 支持全屏录制。  
2. 支持窗口录制。  
3. 支持选择麦克风输入设备。  
4. 支持系统音频采集（Windows 必须支持；macOS 若不可用需提供明确降级提示与继续录制路径）。  

### 6.1.2 录制控制
1. 开始录制。  
2. 暂停/继续录制。  
3. 停止录制并进入编辑界面。  
4. 支持全局快捷键，且可在设置中修改。  

### 6.1.3 录制状态反馈
1. 显示录制中状态、时长、输入源。  
2. 异常时可见错误信息与恢复建议。  

### 6.1.4 平台能力矩阵（MVP 锁定）
1. Windows：全屏/窗口录制、麦克风、系统音频均为 P0 必须。  
2. macOS：全屏/窗口录制、麦克风为 P0 必须；系统音频允许受限降级。  
3. macOS 系统音频降级要求：不可用时提示“当前环境不支持系统音频，仅录制麦克风”，用户可一键继续。  

## 6.2 P0：自动镜头运动模块
### 6.2.1 功能要求
1. 基于鼠标轨迹计算关注区域。  
2. 对关注区域做平移与缩放，突出操作焦点。  
3. 镜头运动平滑，避免抖动与突变。  
4. 提供开关（启用/禁用自动镜头运动）。  
5. 提供强度滑杆（至少 3 档：低/中/高）。  
6. 默认缩放范围：1.0x ~ 2.0x（可在配置中调整上限）。  

### 6.2.2 交互要求
1. 编辑预览可即时反映参数变化。  
2. 参数默认值面向产品演示场景优化（中等跟随、平滑优先）。  

### 6.2.3 可测质量指标（MVP）
1. 焦点切换时延：光标完成大位移后，镜头在 200ms~450ms 内完成主要过渡。  
2. 静止稳定性：光标静止 500ms 后，镜头中心抖动幅度 <= 画面宽度的 1%。  
3. 突变控制：连续帧缩放变化不应出现肉眼可见跳变（通过标准样例回放验收）。  

## 6.3 P0：基础编辑模块
1. 时间线头尾裁剪。  
2. 画布比例切换：16:9、9:16、1:1。  
3. 光标高亮开关（基础样式）。  
4. 预览窗口显示当前剪辑结果。  

## 6.4 P0：导出模块
1. 导出格式：MP4。  
2. 编码基线：视频 H.264，音频 AAC-LC。  
3. 基础导出预设：1080p / 30fps（默认），可选 720p / 30fps。  
4. 默认码率：1080p 8Mbps，720p 4Mbps，音频 128kbps。  
5. 编码回退策略：优先硬件编码，失败后自动回退软件编码。  
6. 导出进度可视化（进度条 + 状态文案）。  
7. 导出失败展示明确原因（权限、空间不足、编码失败等）。  
8. 导出失败后支持重试，不要求重新录制。  
9. 导出失败后保留工程文件与日志，便于复现与反馈。  

## 6.5 P0：开源交付模块
1. `README.md`：产品定位、快速开始、开发启动、贡献入口。  
2. `LICENSE`：开源许可证明确。  
3. `CONTRIBUTING.md`：代码规范、提交流程、Issue/PR 要求。  
4. 基础 Issue 模板：Bug、Feature Request。  

## 6.6 P0：异常恢复模块
1. 录制中断（崩溃/权限变化/设备断开）后，重启应用应检测未完成项目。  
2. 若存在可恢复片段，提供“恢复项目”入口。  
3. 无法恢复时，提供明确原因与临时文件清理提示。  

## 6.7 P1（有余量再做）
1. 简单片头/片尾模板。  
2. 场景化导出预设（产品演示、教程演示）。  

## 7. 非功能需求

### 7.1 性能与稳定性
1. 1080p 常规录制场景下，连续 30 分钟录制不崩溃。  
2. 导出阶段主界面保持可响应（不出现长时间假死）。  
3. 应用冷启动到可开始录制的时间目标：<= 8 秒（建议值）。  
4. 音视频同步偏移：30 分钟录制后 A/V 偏移绝对值 <= 100ms。  
5. 录制掉帧率：标准场景平均掉帧率 <= 2%（峰值 <= 5%）。  
6. 导出成功率：标准测试集（20 条样例）成功率 >= 95%。  

### 7.2 隐私与安全
1. 默认完全离线，无云端依赖。  
2. 默认不采集遥测数据。  
3. 若后续引入遥测，必须为显式可选且默认关闭。  
4. 默认无主动外发网络请求（含崩溃上报、自动遥测、自动上传）。  
5. 更新检查默认关闭；如提供“手动检查更新”，仅在用户触发时联网。  

### 7.3 可维护性
1. 核心模块有基础自动化测试（轨迹平滑、导出状态机、配置解析）。  
2. 日志分级可用（info/warn/error），便于定位问题。  

## 8. 技术方案约束（Tauri）

### 8.1 架构边界
1. 前端（WebView）：界面交互、参数配置、状态展示。  
2. Rust Core：采集协调、轨迹计算、渲染调度、文件 I/O。  
3. 本地文件系统：项目保存与导出产物管理。  

### 8.2 数据模型（MVP 建议）
```ts
type RecordingProfile = {
  captureMode: "fullscreen" | "window";
  frameRate: 30 | 60;
  resolution: "1080p" | "720p";
  microphoneDeviceId?: string;
  systemAudioEnabled: boolean;
  hotkeys: {
    startStop: string;
    pauseResume: string;
  };
};

type CameraMotionProfile = {
  enabled: boolean;
  intensity: "low" | "medium" | "high";
  smoothing: number;      // 0~1
  maxZoom: number;        // e.g. 1.0~2.0
  idleThresholdMs: number;
};

type ExportProfile = {
  format: "mp4";
  resolution: "1080p" | "720p";
  bitrateMbps: number;
  fps: 30 | 60;
  videoCodec: "h264";
  audioCodec: "aac";
};

type ProjectManifest = {
  schemaVersion: 1;
  appVersion: string;
  createdAt: string;
  updatedAt: string;
  recording: RecordingProfile;
  cameraMotion: CameraMotionProfile;
  export: ExportProfile;
  timeline: {
    trimStartMs: number;
    trimEndMs: number;
    aspectRatio: "16:9" | "9:16" | "1:1";
    cursorHighlightEnabled: boolean;
  };
};
```

### 8.3 本地项目结构（建议）
```text
<project-root>/
  project.json
  assets/
    screen.raw-or-intermediate
    audio.raw-or-intermediate
  renders/
    output.mp4
```

`project.json` 至少包含：
1. `schemaVersion` 与版本信息（用于兼容与迁移）。  
2. 录制元数据（时长、分辨率、fps、音频配置）。  
3. 编辑参数（裁剪区间、画布比例、光标高亮）。  
4. 镜头运动参数（开关、强度、平滑系数）。  
5. 导出参数（分辨率、码率、目标路径）。  

### 8.4 配置兼容策略（MVP）
1. 仅接受 `schemaVersion=1` 的工程文件。  
2. 若读取到低版本且可兼容，执行自动迁移并写回新版本。  
3. 若读取到高版本，提示“当前版本不支持该项目文件”，不破坏原文件。  
4. 迁移失败时保留原始文件并生成错误日志。  

## 9. 核心用户流程
1. 用户打开应用 -> 选择录制源与音频输入。  
2. 开始录制 -> 完成演示 -> 停止录制。  
3. 进入编辑页面 -> 调整裁剪、比例、镜头运动参数。  
4. 点击导出 -> 查看进度 -> 生成本地 MP4。  
5. 若失败 -> 查看错误原因 -> 修复后重试导出。  

## 10. 验收标准（Acceptance Criteria）
1. 录制闭环可用：新用户可完成录制到导出全流程。  
2. 自动镜头运动达标：满足 6.2.3 的时延与稳定性指标。  
3. 导出可靠：标准测试集导出成功率 >= 95%，常见错误可提示且可重试。  
4. 音视频同步达标：30 分钟录制后 A/V 偏移绝对值 <= 100ms。  
5. 跨平台可运行：macOS/Windows 基础功能一致性达标，系统音频按能力矩阵降级。  
6. 开源可协作：外部开发者可按文档启动并提交 PR。  

## 11. 测试场景与用例
1. 基础流程测试：全屏录制 5 分钟 + 导出成功。  
2. 长时稳定测试：1080p 连续 30 分钟录制。  
3. 镜头运动测试：快速移动、静止停留、边缘移动三类轨迹。  
4. 编辑一致性测试：裁剪前后时长与导出结果一致。  
5. 异常恢复测试：磁盘空间不足、路径无权限、导出中断。  
6. 跨平台行为测试：权限申请、设备选择、导出成功率。  
7. A/V 同步测试：30 分钟样例中首尾同步偏移绝对值 <= 100ms。  
8. 掉帧测试：标准场景平均掉帧率 <= 2%。  
9. 系统音频能力测试：Windows 必测通过；macOS 验证降级提示和继续流程。  
10. 工程恢复测试：强制中断后重启，验证“恢复项目”与不可恢复提示路径。  

## 12. 里程碑（6 周）
1. 第 1-2 周：录制核心打通 + 基础 UI + 本地项目存储。  
2. 第 3-4 周：自动镜头运动 + 基础编辑 + MP4 导出。  
3. 第 5 周：稳定性修复、性能优化、回归测试。  
4. 第 6 周：开源文档完善、发布打包、对外发布。  

## 13. 风险与缓解
1. 平台能力差异（采集/音频权限）：建立平台能力矩阵与降级路径。  
2. 镜头运动体验不稳定：提供可调参数并先验证默认预设。  
3. 导出性能不足：限制 MVP 导出参数范围，优先稳定性。  
4. 开源首发质量风险：增加冷启动与新机器安装验证清单。  

## 14. 假设与默认决策
1. 目标用户优先产品团队，不扩展到专业视频创作者深度需求。  
2. 首发仅 macOS + Windows，Linux 延后。  
3. 导出仅本地 MP4，不做任何云端能力。  
4. 默认离线，不启用遥测。  
5. MVP 以 6 周节奏交付，超出范围需求转入后续版本。  

## 15. 后续版本方向（非 MVP 承诺）
1. Linux 支持。  
2. 多模板与品牌化输出。  
3. 高级剪辑能力（关键帧、转场、标注）。  
4. 插件化扩展（社区贡献特效与工作流）。  
