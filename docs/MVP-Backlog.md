# FocusLens MVP Backlog（6 周执行版）

## 1. 文档目的
本文件将 `docs/PRD-MVP.md` 转为可执行的 6 周工程 Backlog，目标是让团队直接按任务开工并可周度验收。

## 2. 执行边界
1. 平台范围：macOS + Windows。  
2. 功能范围：仅覆盖 MVP P0，P1 仅在第 6 周有余量时插入。  
3. 隐私策略：默认离线，不做主动外发网络请求。  
4. 导出基线：MP4（H.264 + AAC-LC），默认 1080p/30fps。  

## 3. 模块分解
- `M01` 工程基础与架构骨架
- `M02` 录制引擎（屏幕/窗口/音频输入）
- `M03` 平台能力与权限（含系统音频降级）
- `M04` 编辑与预览（裁剪、比例、光标高亮）
- `M05` 自动镜头运动（鼠标跟随 + 平滑缩放）
- `M06` 导出与编码（进度、重试、回退）
- `M07` 项目文件与异常恢复（`project.json` + `schemaVersion`）
- `M08` 质量保障（自动化测试、性能与稳定性）
- `M09` 开源发布与交付

## 4. 任务标识与状态
1. 任务编号格式：`W{周次}-M{模块}-{序号}`，示例：`W2-M02-03`。  
2. 状态建议：`TODO` / `IN_PROGRESS` / `BLOCKED` / `DONE`。  
3. 完成定义（DoD）：代码合入 + 对应测试通过 + 文档更新。  

## 5. 周度 Backlog

## Week 1（工程基线与录制链路预研）
### 周目标
建立可开发、可调试、可验证的 Tauri 基础工程，打通录制与导出关键技术预研路径。

| 任务ID | 模块 | 任务描述 | 依赖 | 交付物 | 验收标准 |
|---|---|---|---|---|---|
| W1-M01-01 | M01 | 初始化 Tauri 工程结构（前端壳 + Rust Core） | 无 | 可运行工程骨架 | macOS/Windows 均可本地启动主界面 |
| W1-M01-02 | M01 | 建立目录规范与模块边界（capture/edit/export/project/settings） | W1-M01-01 | 目录与模块说明文档 | 模块间接口清晰，避免循环依赖 |
| W1-M01-03 | M01 | 接入统一日志与错误码基础设施 | W1-M01-01 | 日志模块、错误码枚举 | 支持 info/warn/error，错误可追踪 |
| W1-M03-01 | M03 | 权限流程预研：屏幕录制、麦克风、系统音频 | W1-M01-01 | 平台权限能力表 | 明确 Windows/macOS 差异及降级路径 |
| W1-M02-01 | M02 | 采集技术 Spike：全屏/窗口采样可行性验证 | W1-M01-01 | Spike 报告 + Demo | 两平台可获取稳定视频帧 |
| W1-M02-02 | M02 | 音频采集技术 Spike：麦克风 + 系统音频路径验证 | W1-M03-01 | Spike 报告 | Windows 系统音频路径可行，macOS 降级策略明确 |
| W1-M06-01 | M06 | 编码技术 Spike：H.264 + AAC + MP4 封装验证 | W1-M01-01 | Spike 报告 + 最小导出样片 | 可输出可播放 MP4 文件 |
| W1-M07-01 | M07 | 定义 `project.json` v1 草案（含 `schemaVersion`） | W1-M01-02 | JSON Schema 草案 | 字段覆盖录制/编辑/镜头/导出基础配置 |
| W1-M08-01 | M08 | 搭建测试基建（单测 + 集成测试入口） | W1-M01-01 | 测试脚手架 | CI 本地可执行基础测试命令 |

### Week 1 里程碑验收
1. 工程可在双平台启动。  
2. 录制/音频/编码关键方案已完成技术选型。  
3. 已形成能力矩阵与降级策略草案。  

## Week 2（录制 P0 功能落地）
### 周目标
完成录制主流程：选择源、开始/暂停/停止、输入设备选择、状态反馈、平台降级提示。

| 任务ID | 模块 | 任务描述 | 依赖 | 交付物 | 验收标准 |
|---|---|---|---|---|---|
| W2-M02-01 | M02 | 实现全屏录制能力（30fps 基线） | W1-M02-01 | 录制核心代码 | 5 分钟录制无崩溃，视频可播放 |
| W2-M02-02 | M02 | 实现窗口录制能力 | W2-M02-01 | 窗口采集逻辑 | 指定窗口录制结果可用 |
| W2-M02-03 | M02 | 麦克风输入选择与采集 | W1-M02-02 | 设备枚举 + 采集逻辑 | 用户可选择麦克风并成功录制 |
| W2-M03-02 | M03 | Windows 系统音频采集接入 | W1-M02-02 | Windows 音频采集实现 | Windows 场景系统音频可录制 |
| W2-M03-03 | M03 | macOS 系统音频降级提示与继续流程 | W1-M03-01 | UI 提示 + 流程控制 | 不支持时提示准确且可继续录制 |
| W2-M02-04 | M02 | 录制控制（开始/暂停/继续/停止） | W2-M02-01 | 状态机实现 | 状态切换正确，无非法状态跳转 |
| W2-M02-05 | M02 | 全局快捷键（可配置） | W2-M02-04 | 快捷键配置模块 | 快捷键可触发并持久化 |
| W2-M04-01 | M04 | 录制状态 UI（时长/输入源/状态） | W2-M02-04 | 录制页 UI | 录制状态实时、可见、无错乱 |
| W2-M07-02 | M07 | 录制产物落盘与项目初始化 | W2-M02-04, W1-M07-01 | `project.json` + `assets/` 初版写入 | 停止录制后生成可读取项目 |
| W2-M08-02 | M08 | 录制流程集成测试（主路径 + 降级路径） | W2 全部核心任务 | 测试用例 | 双平台主流程回归通过 |

### Week 2 里程碑验收
1. 完整录制主路径可用。  
2. Windows 系统音频与 macOS 降级路径均可验证。  
3. 录制完成后可生成项目文件。  

## Week 3（编辑与镜头运动）
### 周目标
完成基础编辑功能和自动镜头运动 v1，实现可预览、可调参、可保存。

| 任务ID | 模块 | 任务描述 | 依赖 | 交付物 | 验收标准 |
|---|---|---|---|---|---|
| W3-M04-02 | M04 | 时间线头尾裁剪能力 | W2-M07-02 | 裁剪逻辑 | 裁剪区间可视化，结果正确 |
| W3-M04-03 | M04 | 画布比例切换（16:9/9:16/1:1） | W3-M04-02 | 比例转换逻辑 | 预览比例切换正确 |
| W3-M04-04 | M04 | 光标高亮开关（基础样式） | W3-M04-02 | 光标渲染增强 | 开关生效且导出可见 |
| W3-M04-05 | M04 | 编辑预览渲染管线 v1 | W3-M04-02 | 预览渲染模块 | 参数改动后预览可即时更新 |
| W3-M05-01 | M05 | 鼠标轨迹采样与关注区域计算 | W2-M07-02 | 轨迹处理模块 | 可生成连续关注区域轨迹 |
| W3-M05-02 | M05 | 平滑缩放/平移算法 v1（含强度档） | W3-M05-01 | 算法实现 | 低/中/高档位行为可区分 |
| W3-M05-03 | M05 | 镜头运动参数面板（开关、强度） | W3-M05-02 | 设置 UI + 状态绑定 | 参数修改即时影响预览 |
| W3-M05-04 | M05 | 镜头质量指标测试样例（时延/抖动） | W3-M05-02 | 指标测试脚本 | 能输出时延与稳定性结果 |
| W3-M07-03 | M07 | 编辑参数写回 `project.json` | W3-M04-05, W3-M05-03 | 项目持久化逻辑 | 重新打开项目后参数一致 |
| W3-M08-03 | M08 | 编辑与镜头运动回归测试 | W3 全部核心任务 | 测试用例 | 主流程测试通过，核心缺陷闭环 |

### Week 3 里程碑验收
1. 基础编辑可用并可持久化。  
2. 自动镜头运动可开关与调参，预览可见。  
3. 已具备镜头质量指标测试能力。  

## Week 4（导出链路与错误恢复）
### 周目标
打通“编辑结果 -> MP4 导出”全流程，具备进度反馈、失败原因、重试与编码回退。

| 任务ID | 模块 | 任务描述 | 依赖 | 交付物 | 验收标准 |
|---|---|---|---|---|---|
| W4-M06-02 | M06 | 导出任务编排（读取项目 + 渲染参数） | W3-M07-03 | 导出编排模块 | 导出前配置解析正确 |
| W4-M06-03 | M06 | H.264/AAC 导出实现（1080p/720p） | W1-M06-01, W4-M06-02 | 编码管线 | 导出文件可播放，参数正确 |
| W4-M06-04 | M06 | 硬件编码优先 + 软件编码回退 | W4-M06-03 | 回退策略实现 | 强制硬编失败可自动回退成功 |
| W4-M06-05 | M06 | 导出进度与状态事件通道 | W4-M06-02 | 进度事件 API | UI 可实时展示导出进度 |
| W4-M06-06 | M06 | 导出失败分类与错误文案（权限/空间/编码） | W4-M06-03 | 错误映射表 | 用户可见明确可操作提示 |
| W4-M06-07 | M06 | 导出重试机制（不需重录） | W4-M06-06 | 重试逻辑 | 修复环境后可直接重试成功 |
| W4-M04-06 | M04 | 编辑页导出交互整合 | W4-M06-05 | 导出 UI 流程 | 用户可一键导出并跟踪状态 |
| W4-M08-04 | M08 | 导出稳定性测试（标准样例集 20 条） | W4 核心任务 | 测试报告 | 成功率达到 >=95% |
| W4-M07-04 | M07 | 导出日志与产物落盘规范 | W4-M06-06 | `renders/` 与日志规范 | 失败时保留可复现信息 |

### Week 4 里程碑验收
1. 录制-编辑-导出闭环可执行。  
2. 导出失败可解释且可重试。  
3. 导出成功率初步达到指标。  

## Week 5（稳定性与质量冲刺）
### 周目标
聚焦 PRD 指标达成：30 分钟稳定、A/V 同步、掉帧率、异常恢复、兼容策略。

| 任务ID | 模块 | 任务描述 | 依赖 | 交付物 | 验收标准 |
|---|---|---|---|---|---|
| W5-M08-05 | M08 | 长时录制稳定性测试（30 分钟） | W2 核心任务 | 稳定性报告 | 无崩溃，内存无异常增长 |
| W5-M08-06 | M08 | A/V 同步测试与校正策略 | W4-M06-03 | 同步测试报告 + 修复 | 30 分钟偏移绝对值 <=100ms |
| W5-M08-07 | M08 | 掉帧率测试与性能调优 | W2-M02-01, W4-M06-03 | 性能报告 | 平均掉帧 <=2%，峰值 <=5% |
| W5-M05-05 | M05 | 镜头运动参数调优（默认值定版） | W3-M05-04 | 参数基线 | 满足时延/稳定性指标 |
| W5-M07-05 | M07 | `schemaVersion` 读取与迁移机制 | W1-M07-01 | 迁移逻辑 | 低版本可迁移，高版本可保护性失败 |
| W5-M07-06 | M07 | 异常恢复流程（未完成项目检测/恢复入口） | W2-M07-02 | 恢复流程实现 | 中断重启后可恢复或给出明确提示 |
| W5-M06-08 | M06 | 导出异常场景回归（权限/空间/中断） | W4-M06-06 | 回归测试报告 | 错误提示与重试路径有效 |
| W5-M08-08 | M08 | 回归测试冻结与缺陷收敛 | W5 全部任务 | 缺陷清单 | P0 阻塞缺陷清零 |

### Week 5 里程碑验收
1. PRD 关键指标基本达标。  
2. 恢复与兼容策略可用。  
3. 可进入发布准备阶段。  

## Week 6（开源发布与交付）
### 周目标
完成开源发布材料、双平台发布包与对外可用验证。

| 任务ID | 模块 | 任务描述 | 依赖 | 交付物 | 验收标准 |
|---|---|---|---|---|---|
| W6-M09-01 | M09 | 完善 `README.md`（定位、安装、开发、路线图） | W5-M08-08 | README | 新开发者可按文档启动项目 |
| W6-M09-02 | M09 | 完成 `LICENSE` 与 `CONTRIBUTING.md` | W6-M09-01 | 协作文档 | 许可证清晰，贡献流程明确 |
| W6-M09-03 | M09 | 配置 Issue/PR 模板与基础治理规则 | W6-M09-02 | 模板文件 | 缺陷和需求提交结构化 |
| W6-M09-04 | M09 | 产出 macOS/Windows 发布包 | W5-M08-08 | 安装包 | 双平台可安装启动 |
| W6-M08-09 | M08 | 新机器冷启动与安装烟测 | W6-M09-04 | 烟测报告 | 首次启动与主流程可用 |
| W6-M09-05 | M09 | 发布说明与已知限制清单 | W6-M08-09 | Release Notes | 风险与限制透明可见 |
| W6-M09-06 | M09 | 开源首发（仓库公开与版本打标） | W6-M09-05 | `v0.1.0-mvp` 发布 | 用户可下载并完成主流程 |
| W6-M09-07 | M09 | P1 余量任务评估（可选） | W6-M09-06 | 余量评估结论 | 仅在不影响发布质量时执行 |

### Week 6 里程碑验收
1. 开源仓库对外可用。  
2. 双平台安装包可运行。  
3. 文档、流程、限制说明完整。  

## 6. 关键路径（Critical Path）
1. `W1-M02-01` -> `W2-M02-01` -> `W3-M04-05` -> `W4-M06-03` -> `W5-M08-06` -> `W6-M09-04`。  
2. `W1-M02-02` -> `W2-M03-02/W2-M03-03` -> `W5-M08-06`。  
3. `W1-M07-01` -> `W2-M07-02` -> `W3-M07-03` -> `W5-M07-05/W5-M07-06`。  

## 7. 周度验收清单（统一）
1. 本周 `DONE` 任务均满足 DoD。  
2. 本周新增缺陷有责任人、优先级、修复计划。  
3. 主流程回归至少执行 1 次（录制 -> 编辑 -> 导出）。  
4. 文档与代码同步更新，无“口头规则”。  

## 8. 发布阻塞条件（Release Blockers）
1. 30 分钟录制稳定性不达标。  
2. A/V 同步偏移 >100ms。  
3. 导出成功率 <95%。  
4. Windows 系统音频不可用且无替代说明。  
5. macOS 降级流程不可用或提示错误。  
6. 开源文档不完整导致新开发者无法启动项目。  

## 9. 建议执行节奏
1. 每周一冻结本周范围，周三中检，周五验收。  
2. P0 缺陷优先于 P1 功能。  
3. 每周保留 10%~15% 容量用于未知风险与修复。  
